<?xml version="1.0" encoding="UTF-8"?>
<rss  xmlns:atom="http://www.w3.org/2005/Atom" 
      xmlns:media="http://search.yahoo.com/mrss/" 
      xmlns:content="http://purl.org/rss/1.0/modules/content/" 
      xmlns:dc="http://purl.org/dc/elements/1.1/" 
      version="2.0">
<channel>
<title>MEM</title>
<link>https://raphaelsimon.fr/blog/index.html</link>
<atom:link href="https://raphaelsimon.fr/blog/index.xml" rel="self" type="application/rss+xml"/>
<description>Financement, politiques de santé, data et R</description>
<generator>quarto-1.2.335</generator>
<lastBuildDate>Tue, 28 Feb 2023 23:00:00 GMT</lastBuildDate>
<item>
  <title>Une calculette en HAD</title>
  <link>https://raphaelsimon.fr/blog/posts/20230301_calculette_had/index.html</link>
  <description><![CDATA[ 



<p>Lors de discussion avec une collègue, nous avons eu besoin d’avoir rapidement de nombreuses combinaisons de MPP MPA IK et d’observer leurs GHT, mais aussi l’inverse : à partir d’un GHT observer les combinaisons possibles de GHPC. Puisque ma collègue appelait cet outil une “calculette”, j’ai gardé le nom !</p>
<p>Les données sont entièrement en libre accès sur le site de l’ATIH :</p>
<ul>
<li><a href="https://www.atih.sante.fr/guide-methodologique-had-2022">mapping ghpc en ght</a></li>
<li><a href="https://www.atih.sante.fr/guide-methodologique-had-2022">nomenclature (guide méthodo)</a></li>
<li><a href="https://www.atih.sante.fr/tarifs-mco-et-had">tarifs 2022</a></li>
</ul>
<p>Étonnamment nous n’avions pas, à ma connaissance, d’outil interne qui fasse ce simple croisement de données. C’est l’affaire d’un simple Excel bien entendu mais tout entrainement qui amène à ne pas se servir d’Excel comme outil de publication ou visualisation de données me semble justifié (gif anti excel?)</p>
<p>Je procède en deux temps : d’abord je prepare une table de référence puis je la met en page avec <code>{flexdashboard}</code> et <code>{reactable}</code></p>
<section id="préparation-des-données" class="level2">
<h2 class="anchored" data-anchor-id="préparation-des-données">Préparation des données</h2>
<p>On commence par charger les données :</p>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;">library</span>(dplyr, <span class="at" style="color: #657422;">warn.conflicts =</span> <span class="cn" style="color: #8f5902;">FALSE</span>)</span>
<span id="cb1-2"></span>
<span id="cb1-3">dta_raw <span class="ot" style="color: #003B4F;">&lt;-</span> readxl<span class="sc" style="color: #5E5E5E;">::</span><span class="fu" style="color: #4758AB;">read_excel</span>(<span class="st" style="color: #20794D;">"data-raw/ghpc_2022.xlsx"</span>, <span class="at" style="color: #657422;">sheet =</span> <span class="dv" style="color: #AD0000;">3</span>)</span>
<span id="cb1-4">dta_libs_mps <span class="ot" style="color: #003B4F;">&lt;-</span> readxl<span class="sc" style="color: #5E5E5E;">::</span><span class="fu" style="color: #4758AB;">read_excel</span>(<span class="st" style="color: #20794D;">"data-raw/lib_mps.xlsx"</span>)</span>
<span id="cb1-5">dta_tarifs <span class="ot" style="color: #003B4F;">&lt;-</span> readxl<span class="sc" style="color: #5E5E5E;">::</span><span class="fu" style="color: #4758AB;">read_excel</span>(<span class="st" style="color: #20794D;">"data-raw/tarifs2022.xlsx"</span>)</span></code></pre></div>
<blockquote class="blockquote">
<p>NB: Pour les libellés de MP j’avais déjà une table dans un package interne ATIH mais elle est construite simplement à partir du guide méthodo. Pour cet exemple j’ai fait une feuille excel avec mp et libellé issus du guide.</p>
</blockquote>
<p>Il me faut aussi une table avec les bornes de pondération de GHT pour faire correspondre les pondération de GHPC dans un GHT :</p>
<div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1">dta_ght <span class="ot" style="color: #003B4F;">&lt;-</span></span>
<span id="cb2-2">    <span class="fu" style="color: #4758AB;">data.frame</span>(</span>
<span id="cb2-3">        <span class="at" style="color: #657422;">lower_pond =</span></span>
<span id="cb2-4">            <span class="fu" style="color: #4758AB;">seq</span>(</span>
<span id="cb2-5">                <span class="at" style="color: #657422;">from =</span> .<span class="dv" style="color: #AD0000;">57</span>,</span>
<span id="cb2-6">                <span class="at" style="color: #657422;">to =</span> <span class="fl" style="color: #AD0000;">6.57</span>,</span>
<span id="cb2-7">                <span class="at" style="color: #657422;">by =</span> .<span class="dv" style="color: #AD0000;">2</span></span>
<span id="cb2-8">            ),</span>
<span id="cb2-9">        <span class="at" style="color: #657422;">upper_pond =</span> </span>
<span id="cb2-10">            <span class="fu" style="color: #4758AB;">c</span>(</span>
<span id="cb2-11">                <span class="fu" style="color: #4758AB;">seq</span>(</span>
<span id="cb2-12">                    <span class="at" style="color: #657422;">from =</span> .<span class="dv" style="color: #AD0000;">77</span>,</span>
<span id="cb2-13">                    <span class="at" style="color: #657422;">to =</span> <span class="fl" style="color: #AD0000;">6.57</span>,</span>
<span id="cb2-14">                    <span class="at" style="color: #657422;">by =</span> .<span class="dv" style="color: #AD0000;">2</span></span>
<span id="cb2-15">                ),</span>
<span id="cb2-16">                <span class="dv" style="color: #AD0000;">99</span></span>
<span id="cb2-17">            ),</span>
<span id="cb2-18">        <span class="at" style="color: #657422;">ght =</span> <span class="dv" style="color: #AD0000;">1</span><span class="sc" style="color: #5E5E5E;">:</span><span class="dv" style="color: #AD0000;">31</span></span>
<span id="cb2-19">    )</span></code></pre></div>
<p>Je prépare mes données en renommant les colonnes dans un format plus facile à manier en code :</p>
<div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1">dta_select <span class="ot" style="color: #003B4F;">&lt;-</span></span>
<span id="cb3-2">    dta_raw <span class="sc" style="color: #5E5E5E;">|&gt;</span> </span>
<span id="cb3-3">    <span class="fu" style="color: #4758AB;">select</span>(</span>
<span id="cb3-4">        <span class="at" style="color: #657422;">ghpc =</span> GHPC,</span>
<span id="cb3-5">        <span class="at" style="color: #657422;">inat =</span> <span class="st" style="color: #20794D;">`</span><span class="at" style="color: #657422;">Association inattendue</span><span class="st" style="color: #20794D;">`</span>,</span>
<span id="cb3-6">        <span class="at" style="color: #657422;">mpp =</span> MPP,</span>
<span id="cb3-7">        <span class="at" style="color: #657422;">mpa =</span> MPA,</span>
<span id="cb3-8">        <span class="at" style="color: #657422;">ik =</span> IK, </span>
<span id="cb3-9">        <span class="at" style="color: #657422;">t1 =</span> <span class="st" style="color: #20794D;">`</span><span class="at" style="color: #657422;">IPT T1</span><span class="st" style="color: #20794D;">`</span>,</span>
<span id="cb3-10">        <span class="at" style="color: #657422;">t2 =</span> <span class="st" style="color: #20794D;">`</span><span class="at" style="color: #657422;">IPT T2</span><span class="st" style="color: #20794D;">`</span>,</span>
<span id="cb3-11">        <span class="at" style="color: #657422;">t3 =</span> <span class="st" style="color: #20794D;">`</span><span class="at" style="color: #657422;">IPT T3</span><span class="st" style="color: #20794D;">`</span>,</span>
<span id="cb3-12">        <span class="at" style="color: #657422;">t4 =</span> <span class="st" style="color: #20794D;">`</span><span class="at" style="color: #657422;">IPT T4</span><span class="st" style="color: #20794D;">`</span>,</span>
<span id="cb3-13">    )</span></code></pre></div>
<p>Je pivote mes données pour un format long car j’anticipe qu’il sera plus facile de les manier comme ça pour filtrer sur les valeurs de tranches de durée de séquence :</p>
<div class="sourceCode" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1">dta_pivot <span class="ot" style="color: #003B4F;">&lt;-</span></span>
<span id="cb4-2">    dta_select <span class="sc" style="color: #5E5E5E;">|&gt;</span> </span>
<span id="cb4-3">    tidyr<span class="sc" style="color: #5E5E5E;">::</span><span class="fu" style="color: #4758AB;">pivot_longer</span>(</span>
<span id="cb4-4">        <span class="at" style="color: #657422;">cols =</span> <span class="fu" style="color: #4758AB;">c</span>(</span>
<span id="cb4-5">            t1,</span>
<span id="cb4-6">            t2,</span>
<span id="cb4-7">            t3,</span>
<span id="cb4-8">            t4</span>
<span id="cb4-9">        ),</span>
<span id="cb4-10">        <span class="at" style="color: #657422;">names_to =</span> <span class="st" style="color: #20794D;">"tranche"</span>,</span>
<span id="cb4-11">        <span class="at" style="color: #657422;">values_to =</span> <span class="st" style="color: #20794D;">"pond"</span></span>
<span id="cb4-12">    ) <span class="sc" style="color: #5E5E5E;">|&gt;</span> </span>
<span id="cb4-13">    <span class="fu" style="color: #4758AB;">mutate</span>(</span>
<span id="cb4-14">        <span class="at" style="color: #657422;">tranche =</span> <span class="fu" style="color: #4758AB;">factor</span>(</span>
<span id="cb4-15">            tranche,</span>
<span id="cb4-16">            <span class="at" style="color: #657422;">levels =</span> <span class="fu" style="color: #4758AB;">c</span>(<span class="st" style="color: #20794D;">"t1"</span>, <span class="st" style="color: #20794D;">"t2"</span>, <span class="st" style="color: #20794D;">"t3"</span>, <span class="st" style="color: #20794D;">"t4"</span>),</span>
<span id="cb4-17">            <span class="at" style="color: #657422;">labels =</span> <span class="fu" style="color: #4758AB;">c</span>(<span class="st" style="color: #20794D;">"J1-J4"</span>, <span class="st" style="color: #20794D;">"J5-J9"</span>, <span class="st" style="color: #20794D;">"J10-J30"</span>, <span class="st" style="color: #20794D;">"J31-sortie"</span>)</span>
<span id="cb4-18">        )</span>
<span id="cb4-19">    )</span></code></pre></div>
<p>Je souhaite aussi avoir une homogénéité dans les valeurs d’IK alors je vais transformer l’ik pour extraire les quelques valeurs double (XX-XX) puis à nouveau pivoter en long</p>
<div class="sourceCode" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1">dta_mutateik <span class="ot" style="color: #003B4F;">&lt;-</span></span>
<span id="cb5-2">    dta_pivot <span class="sc" style="color: #5E5E5E;">|&gt;</span> </span>
<span id="cb5-3">    <span class="fu" style="color: #4758AB;">mutate</span>(</span>
<span id="cb5-4">        <span class="at" style="color: #657422;">ik1 =</span> stringr<span class="sc" style="color: #5E5E5E;">::</span><span class="fu" style="color: #4758AB;">str_extract</span>(</span>
<span id="cb5-5">            <span class="at" style="color: #657422;">string =</span> ik, </span>
<span id="cb5-6">            <span class="at" style="color: #657422;">pattern =</span> <span class="st" style="color: #20794D;">"^</span><span class="sc" style="color: #5E5E5E;">\\</span><span class="st" style="color: #20794D;">d+"</span></span>
<span id="cb5-7">        ),</span>
<span id="cb5-8">        <span class="at" style="color: #657422;">ik2 =</span> stringr<span class="sc" style="color: #5E5E5E;">::</span><span class="fu" style="color: #4758AB;">str_extract</span>(</span>
<span id="cb5-9">            <span class="at" style="color: #657422;">string =</span> ik, </span>
<span id="cb5-10">            <span class="at" style="color: #657422;">pattern =</span> <span class="st" style="color: #20794D;">"</span><span class="sc" style="color: #5E5E5E;">\\</span><span class="st" style="color: #20794D;">d+$"</span></span>
<span id="cb5-11">        )</span>
<span id="cb5-12">    ) <span class="sc" style="color: #5E5E5E;">|&gt;</span> </span>
<span id="cb5-13">    <span class="fu" style="color: #4758AB;">select</span>(<span class="sc" style="color: #5E5E5E;">-</span>ik)</span>
<span id="cb5-14"></span>
<span id="cb5-15">dta_pivotik <span class="ot" style="color: #003B4F;">&lt;-</span></span>
<span id="cb5-16">    dta_mutateik <span class="sc" style="color: #5E5E5E;">|&gt;</span> </span>
<span id="cb5-17">    tidyr<span class="sc" style="color: #5E5E5E;">::</span><span class="fu" style="color: #4758AB;">pivot_longer</span>(</span>
<span id="cb5-18">        <span class="at" style="color: #657422;">cols =</span> <span class="fu" style="color: #4758AB;">c</span>(ik1, ik2),</span>
<span id="cb5-19">        <span class="at" style="color: #657422;">names_to =</span> <span class="st" style="color: #20794D;">"ik_val"</span>,</span>
<span id="cb5-20">        <span class="at" style="color: #657422;">values_to =</span> <span class="st" style="color: #20794D;">"ik"</span></span>
<span id="cb5-21">    ) <span class="sc" style="color: #5E5E5E;">|&gt;</span> </span>
<span id="cb5-22">    <span class="fu" style="color: #4758AB;">select</span>(<span class="sc" style="color: #5E5E5E;">-</span>ik_val) <span class="sc" style="color: #5E5E5E;">|&gt;</span> </span>
<span id="cb5-23">    <span class="fu" style="color: #4758AB;">distinct</span>()</span></code></pre></div>
<p>Puis avec de simples jointures je crée une table unique.</p>
<div class="sourceCode" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1">dta_join <span class="ot" style="color: #003B4F;">&lt;-</span></span>
<span id="cb6-2">    dta_pivotik <span class="sc" style="color: #5E5E5E;">|&gt;</span> </span>
<span id="cb6-3">    <span class="fu" style="color: #4758AB;">left_join</span>(</span>
<span id="cb6-4">        <span class="at" style="color: #657422;">y =</span> dta_ght,</span>
<span id="cb6-5">        <span class="at" style="color: #657422;">by =</span> <span class="fu" style="color: #4758AB;">join_by</span>(pond <span class="sc" style="color: #5E5E5E;">&gt;=</span> lower_pond, pond <span class="sc" style="color: #5E5E5E;">&lt;</span> upper_pond)</span>
<span id="cb6-6">    ) <span class="sc" style="color: #5E5E5E;">|&gt;</span> </span>
<span id="cb6-7">    <span class="fu" style="color: #4758AB;">left_join</span>(</span>
<span id="cb6-8">        <span class="at" style="color: #657422;">y =</span> dta_tarifs,</span>
<span id="cb6-9">        <span class="at" style="color: #657422;">by =</span> <span class="st" style="color: #20794D;">"ght"</span></span>
<span id="cb6-10">    )</span></code></pre></div>
<p>J’ajoute les libellés pour une lecture plus facile</p>
<div class="sourceCode" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1">dta_libs <span class="ot" style="color: #003B4F;">&lt;-</span> </span>
<span id="cb7-2">    dta_join <span class="sc" style="color: #5E5E5E;">|&gt;</span> </span>
<span id="cb7-3">    <span class="fu" style="color: #4758AB;">left_join</span>(</span>
<span id="cb7-4">        <span class="at" style="color: #657422;">y =</span> dta_libs_mps,</span>
<span id="cb7-5">        <span class="at" style="color: #657422;">by =</span> <span class="fu" style="color: #4758AB;">c</span>(<span class="st" style="color: #20794D;">"mpp"</span> <span class="ot" style="color: #003B4F;">=</span> <span class="st" style="color: #20794D;">"code"</span>)</span>
<span id="cb7-6">    ) <span class="sc" style="color: #5E5E5E;">|&gt;</span> </span>
<span id="cb7-7">    <span class="fu" style="color: #4758AB;">rename</span>(<span class="at" style="color: #657422;">libmpp =</span> libmp) <span class="sc" style="color: #5E5E5E;">|&gt;</span> </span>
<span id="cb7-8">    <span class="fu" style="color: #4758AB;">left_join</span>(</span>
<span id="cb7-9">        <span class="at" style="color: #657422;">y =</span> dta_libs_mps,</span>
<span id="cb7-10">        <span class="at" style="color: #657422;">by =</span> <span class="fu" style="color: #4758AB;">c</span>(<span class="st" style="color: #20794D;">"mpa"</span> <span class="ot" style="color: #003B4F;">=</span> <span class="st" style="color: #20794D;">"code"</span>)</span>
<span id="cb7-11">    ) <span class="sc" style="color: #5E5E5E;">|&gt;</span> </span>
<span id="cb7-12">    <span class="fu" style="color: #4758AB;">rename</span>(<span class="at" style="color: #657422;">libmpa =</span> libmp) <span class="sc" style="color: #5E5E5E;">|&gt;</span> </span>
<span id="cb7-13">    <span class="fu" style="color: #4758AB;">mutate</span>(</span>
<span id="cb7-14">        <span class="at" style="color: #657422;">libmpp =</span> <span class="fu" style="color: #4758AB;">paste0</span>(mpp, <span class="st" style="color: #20794D;">" : "</span>, libmpp),</span>
<span id="cb7-15">        <span class="at" style="color: #657422;">libmpa =</span> <span class="fu" style="color: #4758AB;">paste0</span>(mpa, <span class="st" style="color: #20794D;">" : "</span>, libmpa),</span>
<span id="cb7-16">        <span class="at" style="color: #657422;">ik =</span> <span class="fu" style="color: #4758AB;">as.integer</span>(ik)</span>
<span id="cb7-17">    )</span></code></pre></div>
<p>Et ma table est prête à être utilisée. Je peux la sauvegarder dans un fichier Excel, ou mieux un fichier .rds qui prend moins de place et charge plus vite avec R :</p>
<div class="sourceCode" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1">bdd <span class="ot" style="color: #003B4F;">&lt;-</span></span>
<span id="cb8-2">    dta_libs <span class="sc" style="color: #5E5E5E;">|&gt;</span> </span>
<span id="cb8-3">    <span class="fu" style="color: #4758AB;">select</span>(</span>
<span id="cb8-4">        mpp, libmpp, mpa, libmpa, ik, tranche, ghpc, ght, tarif_pub, tarif_pri, inat</span>
<span id="cb8-5">    ) <span class="sc" style="color: #5E5E5E;">|&gt;</span> </span>
<span id="cb8-6">    <span class="fu" style="color: #4758AB;">arrange</span>(</span>
<span id="cb8-7">        mpp,</span>
<span id="cb8-8">        mpa,</span>
<span id="cb8-9">        ik,</span>
<span id="cb8-10">        tranche</span>
<span id="cb8-11">    )</span>
<span id="cb8-12"></span>
<span id="cb8-13"><span class="fu" style="color: #4758AB;">saveRDS</span>(bdd, <span class="st" style="color: #20794D;">"data/bdd.rds"</span>)</span></code></pre></div>
<p>Ma table finale ressemble à ça :</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>  mpp                       libmpp mpa  libmpa ik tranche ghpc ght tarif_pub
1  01 01 : Assistance respiratoire  00 00 : NA 10   J1-J4 1902  20    408.73
2  01 01 : Assistance respiratoire  00 00 : NA 10   J5-J9 1902  14    299.10
3  01 01 : Assistance respiratoire  00 00 : NA 10 J10-J30 1902  13    280.81
  tarif_pri inat
1    406.87  non
2    297.64  non
3    279.43  non</code></pre>
</div>
</div>
</section>
<section id="visualisation" class="level2">
<h2 class="anchored" data-anchor-id="visualisation">Visualisation</h2>
<p>Pour mettre ce tableau en page je vais utiliser <code>{flexdashboard}</code>, avec une disposition <code>sidebar</code> pour pouvoir mettre des elements à côté de la table.</p>
<p>Je crée un fichier .Rmd avec l’entête suivant :</p>
<div class="sourceCode" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode yaml code-with-copy"><code class="sourceCode yaml"><span id="cb10-1"><span class="pp" style="color: #AD0000;">---</span></span>
<span id="cb10-2"><span class="fu" style="color: #4758AB;">title</span><span class="kw" style="color: #003B4F;">:</span><span class="at" style="color: #657422;"> </span><span class="st" style="color: #20794D;">"Calculette GHT HAD"</span></span>
<span id="cb10-3"><span class="fu" style="color: #4758AB;">output</span><span class="kw" style="color: #003B4F;">:</span></span>
<span id="cb10-4"><span class="at" style="color: #657422;">    flexdashboard:</span><span class="fu" style="color: #4758AB;">:flex_dashboard</span><span class="kw" style="color: #003B4F;">:</span></span>
<span id="cb10-5"><span class="at" style="color: #657422;">        </span><span class="fu" style="color: #4758AB;">vertical_layout</span><span class="kw" style="color: #003B4F;">:</span><span class="at" style="color: #657422;"> fill</span></span>
<span id="cb10-6"><span class="at" style="color: #657422;">        </span><span class="fu" style="color: #4758AB;">theme</span><span class="kw" style="color: #003B4F;">:</span></span>
<span id="cb10-7"><span class="at" style="color: #657422;">            </span><span class="fu" style="color: #4758AB;">version</span><span class="kw" style="color: #003B4F;">:</span><span class="at" style="color: #657422;"> </span><span class="dv" style="color: #AD0000;">4</span></span>
<span id="cb10-8"><span class="at" style="color: #657422;">            </span><span class="fu" style="color: #4758AB;">bootswatch</span><span class="kw" style="color: #003B4F;">:</span><span class="at" style="color: #657422;"> cyborg</span></span>
<span id="cb10-9"><span class="pp" style="color: #AD0000;">---</span></span></code></pre></div>
<p>Je charge les librairies dont je vais avoir besoin :</p>
<div class="sourceCode" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb11-1"><span class="in" style="color: #5E5E5E;">```{r}</span></span>
<span id="cb11-2"><span class="co" style="color: #5E5E5E;">#| include: false</span></span>
<span id="cb11-3"><span class="fu" style="color: #4758AB;">library</span>(htmltools)</span>
<span id="cb11-4"><span class="fu" style="color: #4758AB;">library</span>(shiny)</span>
<span id="cb11-5"><span class="fu" style="color: #4758AB;">library</span>(reactable)</span>
<span id="cb11-6"><span class="fu" style="color: #4758AB;">library</span>(reactablefmtr)</span>
<span id="cb11-7"><span class="fu" style="color: #4758AB;">library</span>(crosstalk)</span>
<span id="cb11-8"><span class="fu" style="color: #4758AB;">library</span>(hadcalculette)</span>
<span id="cb11-9"><span class="fu" style="color: #4758AB;">library</span>(flexdashboard)</span>
<span id="cb11-10"><span class="in" style="color: #5E5E5E;">```</span></span></code></pre></div>
<p>Et je charge les données, et je les passe à <code>{crosstalk}</code> dans un objet partagé:</p>
<div class="sourceCode" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb12-1"><span class="in" style="color: #5E5E5E;">```{r}</span></span>
<span id="cb12-2">bdd <span class="ot" style="color: #003B4F;">&lt;-</span> <span class="fu" style="color: #4758AB;">readRDS</span>(<span class="st" style="color: #20794D;">"bdd.rds"</span>)</span>
<span id="cb12-3">shared_bdd <span class="ot" style="color: #003B4F;">&lt;-</span> SharedData<span class="sc" style="color: #5E5E5E;">$</span><span class="fu" style="color: #4758AB;">new</span>(bdd)</span>
<span id="cb12-4"><span class="in" style="color: #5E5E5E;">```</span></span></code></pre></div>
<p>Ensuite, je voudrais pouvoir filtrer sur mes éléments d’interet : mpp mpa ik ght et tranche J’utilise {crosstalk} pour faire communiquer des inputs avec la table.</p>
<p>Je commence par créer la partie UI avec des filtres comme celui-ci :</p>
<div class="sourceCode" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb13-1"><span class="in" style="color: #5E5E5E;">```{r}</span></span>
<span id="cb13-2"><span class="fu" style="color: #4758AB;">filter_select</span>(</span>
<span id="cb13-3">    <span class="at" style="color: #657422;">id =</span> <span class="st" style="color: #20794D;">"mpp"</span>,</span>
<span id="cb13-4">    <span class="at" style="color: #657422;">label =</span> <span class="st" style="color: #20794D;">"MPP"</span>,</span>
<span id="cb13-5">    <span class="at" style="color: #657422;">sharedData =</span> shared_bdd,</span>
<span id="cb13-6">    <span class="at" style="color: #657422;">group =</span> <span class="sc" style="color: #5E5E5E;">~</span>libmpp</span>
<span id="cb13-7">)</span>
<span id="cb13-8"><span class="in" style="color: #5E5E5E;">```</span></span></code></pre></div>
<p>Et de l’autre côté j’encapsule ma table dans un format réactif avec <code>{reactable}</code>&gt;</p>
<p>Puis une fois satisfait je connecte avec les données du tableau pour qu’il soit filtré quand je fais des choix. NB: Il y a aussi des filtres puissants dans {reactable} mais je suis plus à l’aise visuellement avec mes filtres à gauche en menu déroulant plutôt que les filtres texte libre de {reactable}</p>
<p>Le code complet de cette portion est disponible <a href="https://github.com/rsimonmd/calculettehad/blob/main/index.Rmd">dans le dépôt</a></p>
<p>Et voilà le travail! Il n’y a plus qu’à déployer sur github pages ou équivalent</p>
<p>A bientôt,</p>
<p>Raphaël</p>


</section>

 ]]></description>
  <category>HAD</category>
  <category>outils</category>
  <category>serverless</category>
  <category>R</category>
  <guid>https://raphaelsimon.fr/blog/posts/20230301_calculette_had/index.html</guid>
  <pubDate>Tue, 28 Feb 2023 23:00:00 GMT</pubDate>
  <media:content url="https://raphaelsimon.fr/blog/posts/20230301_calculette_had/calculator.jpg" medium="image" type="image/jpeg"/>
</item>
<item>
  <title>Résolutions</title>
  <link>https://raphaelsimon.fr/blog/posts/20230115_nouveaudepart/index.html</link>
  <description><![CDATA[ 



<section id="changement-de-mentalité" class="level2">
<h2 class="anchored" data-anchor-id="changement-de-mentalité">Changement de mentalité</h2>
<p>J’essaie de blogger depuis l’âge de 12 ans, soit 2003. A l’époque, j’essayais de convaincre mon ami Alexis (brave homme de m’avoir toléré et continuer à le faire) de monter un blog sur lequel on parlerai de musique. Et pour cause, une révolution arrive : Wordpress débarque et c’est trop facile pour des petits geeks de créer un blog avec !<br>
Sauf que je n’ai rien écris ou presque, au delà d’une premier jet de premier article.</p>
<p>Et depuis, régulièrement mon cerveau me relance sur l’idée, soit avec les évolutions de Wordpress, mais aussi à l’époque Skyblog, l’époque MySpace … chaque nouveauté donne envie de se relancer. Mon meilleur effort était en 2017-2018 où <a href="https://ninemonthseightdays.wordpress.com/">je tiens un blog pendant quelques semaines</a> pour documenter mon année à Londres.</p>
<p>Fin 2018 je découvre R, <code>Rmarkdown</code> et le package <code>{blogdown}</code> et ça relance ma ferveur. Je gagne en autonomie sur le développement web et j’adore ! Plein d’idées de sites, d’applications et surtout de BLOG. Je crée Obvie avec Hugo (brave homme aussi) pour représenter nos projets, dont le principal à ce moment est l’application de suivi des choix de l’ECNi. Du coup, il nous faut <a href="https://www.obvieapps.fr/">un site pour l’accompagner</a>, et surtout un blog pour tous nos articles et idées. Je dev, je dev, il y a tout à apprendre : HTML, CSS, Javascript, faire des tests … C’est chouette, mais on publie peu (pas)</p>
<p>Juin 2021, ma curiosité est piquée de nouveau car je tombe sur un <a href="https://github.com/hugo-apero/">article par Alison Presmanes Hill</a> qui présente un nouveau patron de blog pour blogdown, qui a l’air a la fois <em>simple</em> et <em>complet</em> : le rêve, je vais pouvoir me concentrer sur l’écriture et moins sur le fignolage du site. Alors j’achète le domaine raphaelsimon.fr, je crée le projet, balancé sur Github, synchronisé avec Netlify, j’écris un premier article et puis je me prépare à publier. Je me dis alors que je ne vais pas assumer d’avoir un seul article, “c’est bien pauvre”. En plus, j’ai gardé la plupart des réglages par défaut du thème, mon site ressemble à tous les sites issus du même thême, malédiction ! Alors je prends des heures à travailler le CSS et …</p>
<p>Et c’est le coeur du problème : je ne publie rien tant que je ne suis pas satisfait de l’aspect graphique du site. Mon site est à l’abandon et en plus, j’ai maintenant l’angoisse inverse, je possède le nom de domaine et je n’en fais rien!</p>
<p>Initialement sans relation entre les deux sujets, en janvier 2022 j’ai fait une petite expérience. J’ai voulu travailler ma discipline, sous la forme d’un exercice quotidien, simple et rapide, auquel m’astreindre pendant un an pour en faire un bilan en janvier 2023. Puisque j’aime les langues, je choisis d’en apprendre une nouvelle. Mon dévolu est jetté sur l’Allemand, sans autre raison que l’association mentale que je fais entre ce langage et les mathématiques/algorithmes (basé sur les on-dits du collège, quand j’ai choisi de faire de l’espagnol et qu’on me disait “l’allemand c’est un langage qui se construit comme des formules de maths”. Comme quoi, il en faut peu …).<br>
Avec Duolingo, je fais 10-15 minutes d’exercices tous les jours et <strong>je m’y tiens</strong> !</p>
<p>Fin 2022 je fais donc un bilan de ce succès :<br>
- C’était plus facile que je le pensais<br>
- C’est agréable et auto-valorisant de se voir tenir une discipline stricte - Je veux répéter ce genre d’expérience pour prendre d’autres habitudes - Je parle un peu Allemand, comme un collégien de fin de 3e probablement?</p>
<p>Pour moi, la clef du succès de cette expérience c’est l’absence d’attentes. Mon seul objectif était de tenir le rythme quotidien, peu importe le temps passé, peu importe le rythme de progression. Au final, j’ai même sur la fin de l’année fait plutôt 20-25 min par jour, au delà de ma cible initiale, <em>car j’ai pris goût à ce rituel</em> !</p>
<p>Ainsi, en 2023 je continue l’allemand, et j’ai introduit une nouvelle routine quodidienne. Pour ne pas risquer de tomber dans les travers décrits, je n’en parlerai que lorsque je m’y serait tenu 1 an. Toutefois, en accompagment, j’ai décidé de refaire mon site mais cette fois-ci de le publier tel quel, a peine sorti de son modèle. Si j’ai raison et que mes précédents échecs tiennent à un sur-investissement initial et un manque d’investissement dans la durée, alors j’espère que cette approche me permettra de prendre l’habitude d’écrire.</p>
<p>Je n’ai pas d’objectif de thème pour ce site, ni de langue, ni de rythme de contenu. Je souhaite simplement venir régulièrement l’ouvrir et copier-coller des choses écrites ailleurs, et uniquement travailler sur les aspects graphiques quand j’en sentirai l’envie. Je suis absolument furieux de l’état du mode sombre, les choix d’images, certains ratios … mais tant pis. Ecrire, et surtout publier, c’est de toute façon prendre le risque d’exposer un produit imparfait à la critique d’inconnus. Il vaut mieux que ça sorte plutôt que pas du tout, et je compte sur la pression de savoir que le site est en ligne en l’état pour me motiver à venir l’améliorer régulièrement.</p>
<p>Bilan dans 1 an !</p>
<p>A bientôt,</p>
<p>Raphaël</p>


</section>

 ]]></description>
  <category>meta</category>
  <guid>https://raphaelsimon.fr/blog/posts/20230115_nouveaudepart/index.html</guid>
  <pubDate>Sat, 14 Jan 2023 23:00:00 GMT</pubDate>
  <media:content url="https://raphaelsimon.fr/blog/posts/20230115_nouveaudepart/featured.jpg" medium="image" type="image/jpeg"/>
</item>
</channel>
</rss>
